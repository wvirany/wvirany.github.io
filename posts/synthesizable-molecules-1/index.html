<!DOCTYPE html>
<html lang="en-us"
  dir="ltr">

  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width">



<link rel="icon" type="image/ico" href="http://localhost:1313//favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313//favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313//favicon-32x32.png">
<link rel="icon" type="image/png" sizes="192x192" href="http://localhost:1313//android-chrome-192x192.png">
<link rel="apple-touch-icon" sizes="180x180" href="http://localhost:1313//apple-touch-icon.png">

<meta name="description" content=""/>

<title>
    
    Generating Synthesizable Molecules (1/2) | Walter Virany
    
</title>

<link rel="canonical" href="http://localhost:1313/posts/synthesizable-molecules-1/"/>












<link rel="stylesheet" href="/assets/combined.min.21c8c428eaa5526b0eeb8711e7d5b7ae76e1e4e2157c1f7fd51a4b910fa9523b.css" media="all">





  </head>

  

  
  
  

  <body class="light">

    <div class="content">
      <header>
        

<div class="header">

    

    <h1 class="header-title">Walter Virany</h1>

    <div class="flex">
        

        
        
      
        <p class="small ">
            <a href="/" >
                /home
            </a>
        </p>
        
      
        <p class="small ">
            <a href="/about" >
                /about
            </a>
        </p>
        
        
    </div>

    

</div>

      </header>

      <main class="main">
        







<div >

  <div class="single-intro-container">

    

    <h1 class="single-title">Generating Synthesizable Molecules (1/2)</h1>
    
    <p class="single-summary">Part 1: Projecting Molecules into Synthesizable Chemical Spaces</p>
    

    

    <p class="single-readtime">
      

      
      &nbsp; · &nbsp;
      2 min read
      
    </p>

  </div>

  

  

  

  

  <div class="single-content">
    <p>A significant challenge in the use of generative modeling for molecular design is the problem of synthesizability. That is, a fancy deep learning model might make a molecule that checks all of our boxes in terms of desirable properties, but can it actually be synthesized in a lab? If the answer is no, then that <em>in silico</em> molecule is not very useful.</p>
<p>There are many attempts to overcome this problem, but one elegant approach is the work of <a href="https://arxiv.org/pdf/2406.04628">Luo et al. [2024]</a>, in which they &ldquo;project&rdquo; molecules into synthesizable chemical space.</p>
<p>I&rsquo;ve reimplemented this paper with some minor simplifications to demonstrate stuff&hellip;</p>
<h3 id="prelims">Prelims</h3>
<p>Here are a few packages we&rsquo;ll use:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#00f">import</span> torch
</span></span><span style="display:flex;"><span><span style="color:#00f">import</span> torch.nn <span style="color:#00f">as</span> nn
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00f">from</span> rdkit <span style="color:#00f">import</span> Chem
</span></span><span style="display:flex;"><span><span style="color:#00f">from</span> rdkit.Chem <span style="color:#00f">import</span> AllChem, rdChemReactions
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00f">from</span> typing <span style="color:#00f">import</span> List, Dict, Union
</span></span></code></pre></div><h3 id="defining-chemical-space">Defining Chemical Space</h3>
<p>We can define a chemical space $\mathcal{C}$ as a set of molecules generated by a set of building block molecules, denoted</p>
<p>$$
\mathcal{B} = {B_1, B_2, \dots, B_N},
$$</p>
<p>and a set of reaction rules, denoted</p>
<p>$$
\mathcal{R} = {R_1, R_2, \dots, R_M}.
$$</p>
<p>A reaction rule is a function which maps a set of reactions to a set of reaction products. This can be formalized as</p>
<p>$$
\begin{align*}
R: \mathcal{X_1} \times \mathcal{X_2} &amp;\to \mathcal{C}, \quad \text{or} \\
(X_1, X_2) &amp;\mapsto Y.
\end{align*}
$$</p>
<p>Here, $\mathcal{X_1}$ and $\mathcal{X_2}$ are sets of molecules to which reaction $R$ can be applied, and $Y$ is the main reaction product. $\mathcal{C}$ is then constructed by applying the reactions iteratively to every possible combination of molecules. For the sake of clarity, we assume the reaction only has one main product, although this is not always the case. However, the implementation which follows supports both cases.</p>
<p>Let&rsquo;s implement this. We start by defining <code>Molecule</code> and <code>Reaction</code> classes:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#00f">class</span> <span style="color:#2b91af">Molecule</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#00f">def</span> __init__(self, smiles: str):
</span></span><span style="display:flex;"><span>        self.smiles = smiles
</span></span><span style="display:flex;"><span>        self._rdmol = Chem.MolFromSmiles(smiles)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    @property
</span></span><span style="display:flex;"><span>    <span style="color:#00f">def</span> rdmol(self):
</span></span><span style="display:flex;"><span>        <span style="color:#00f">return</span> self._rdmol
</span></span></code></pre></div><h3 id="postfix-notation-of-synthesis">Postfix Notation of Synthesis</h3>
<p>In this work, the authors formalize the synthetic process as a sequence of function calls, organized in a stack.</p>
<h3 id="references-and-further-reading">References and Further Reading</h3>
<ol>
<li>Shitong Luo, Wenhao Gao, Zuofan Wu, Jian Peng, Connor W. Coley, and Jianzhu Ma. Projecting molecules into
synthesizable chemical spaces. In Forty-first International Conference on Machine Learning, 2024.</li>
</ol>

    
  </div>

  

  
  

<div class="single-pagination">
    <hr />

    <div class="flex">

        <div class="single-pagination-prev">
            
        </div>

        <div class="single-pagination-next">
            
            <div class="single-pagination-container-next">
                <div class="single-pagination-text">
                    <a href="/posts/nngp/">
                        Understanding the Neural Network Gaussian Process
                    </a>
                </div>
                <div class="single-pagination-text">→</div>
            </div>
            
        </div>

    </div>

    <hr />
</div>



  

  

  
  <div class="back-to-top">
    <a href="#top">
      back to top
    </a>
  </div>
  

</div>


      </main>
    </div>

    <footer>
      
<link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css">
<script defer
  src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js"></script>

<script defer
  src="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js"
  onload="renderMathInElement(document.body);"></script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    renderMathInElement(document.body, {
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false }
      ]
    });
  });
</script>

    </footer>

  </body>

  <script>

  function isAuto() {
    return document.body.classList.contains("auto");
  }

  function setTheme() {
    if (!isAuto()) {
      return
    }

    document.body.classList.remove("auto");
    let cls = "light";
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
      cls = "dark";
    }

    document.body.classList.add(cls);
  }

  function invertBody() {
    document.body.classList.toggle("dark");
    document.body.classList.toggle("light");
  }

  if (isAuto()) {
    window.matchMedia('(prefers-color-scheme: dark)').addListener(invertBody);
  }

  setTheme();

</script>


<script>
  
  function updateFigureNumbers() {

      const figRefs = document.querySelectorAll('.fig-ref');
      figRefs.forEach(ref => {
          const figId = ref.getAttribute('href').slice(1);
          const figElement = document.getElementById(figId);
          if (figElement) {
              const figIndex = Array.from(figures).indexOf(figElement) + 1;
              ref.textContent = `Figure ${figIndex}`;
          }
      });
  }

  
  window.addEventListener('load', updateFigureNumbers);
</script>



</html>